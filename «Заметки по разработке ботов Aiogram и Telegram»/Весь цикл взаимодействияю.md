Весь цикл взаимодействия
Прежде чем перейти к тому как устроены боты, давайте поймем где их место вообще во всей цепочке. Широкими мазками, так сказать. У нас есть само приложение Telegram - клиент на смартфоне, десктопе или вебе - не важно. У нас есть сервера Telegram, через которые происходит взаимодействие между пользователями и/или сервисами и у нас есть сам бот, а точнее его бэкэнд - программа, которая обрабатывает действия пользователей.


Когда пользователь через приложение (клиент) Telegram как-то взаимодействует с ботом-аккаунтом (пишет ему сообщение, нажимает на инлайн-кнопку под сообщением или выбирает команду в меню) - приложение отправляет запрос на Telegram-сервер. Сервер понимает, что это обращение к боту и, в зависимости от того как настроен бот, либо отправляет запрос к боту, либо ждет запрос от бота, чтобы передать ему данные о действии пользователя.

Есть две основные технологии, которыми бот может получать то, что ему предназначено от сервера. Long polling и Webhook. Суть лонг поллинга состоит в том, чтобы постоянно опрашивать сервер на наличие обновлений (апдейтов), предназначенных боту, типа, "Есть, там, чего для меня?". А webhook - это когда сам сервер "стучится" к боту и говорит: "Тебе что-то пришло!", когда для бота что-то приходит. Сейчас не будем заострять на этих технологиях внимание, о них будет подробно далее в курсе. Long polling используется, в основном, на этапе разработки и тестирования бота, часто на компьютере самого разработчика, а webhook, когда бот уже запущен в продакшн.

Так вот, бот получает апдейты от сервера, что-то с ними делает и отправляет результат обратно на сервер. Сервер понимает кому из пользователей предназначено сообщение и пересылает его в приложение пользователя.

Общение между ботом и с ервером происходит в виде http-запросов.